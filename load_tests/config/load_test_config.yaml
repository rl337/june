# Load Testing Configuration
# This file configures load test scenarios and target endpoints
#
# Note: Gateway service was removed for MVP. Services now communicate directly via gRPC.
# Gateway REST/WebSocket tests are obsolete and kept for reference only.

# Service endpoints
services:
  # Gateway service - OBSOLETE (service removed, kept for reference only)
  # gateway:
  #   host: "http://localhost:8000"
  #   rest_endpoints: [...]
  #   websocket: [...]
  
  # gRPC Services - Active
  grpc:
    # LLM Inference Service
    # Default: TensorRT-LLM (tensorrt-llm:8000 in home_infra/shared-network)
    # Alternative: NVIDIA NIM (nim-qwen3:8001 in home_infra/shared-network)
    # Legacy: inference-api (inference-api:50051, use --profile legacy)
    tensorrt_llm:
      host: "tensorrt-llm:8000"  # Default LLM service (TensorRT-LLM)
      weight: 30
    # Legacy inference-api (deprecated, use --profile legacy)
    # inference_api:
    #   host: "localhost:50051"
    #   weight: 30
    stt:
      host: "localhost:50052"
      weight: 20
    tts:
      host: "localhost:50053"
      weight: 20

# Load test scenarios
scenarios:
  # Baseline load - current capacity
  baseline:
    users: 10
    spawn_rate: 2
    duration: "5m"
    description: "Baseline load test to establish current capacity"
  
  # Target load - 10x capacity
  target:
    users: 100
    spawn_rate: 10
    duration: "10m"
    description: "Target load test for 10x capacity validation"
  
  # Gradual ramp-up
  ramp_up:
    users: 200
    spawn_rate: 5
    duration: "20m"
    description: "Gradual ramp-up to test system under increasing load"
  
  # Spike test
  spike:
    users: 500
    spawn_rate: 50
    duration: "5m"
    description: "Sudden spike test to verify system recovery"
  
  # Sustained load
  sustained:
    users: 150
    spawn_rate: 10
    duration: "30m"
    description: "Sustained load test to identify memory leaks and stability issues"

# Metrics to collect
metrics:
  latency:
    percentiles: [50, 75, 90, 95, 99]
  throughput:
    window: "1m"
  error_rate:
    threshold: 0.01  # 1% error rate threshold
  resource_utilization:
    - cpu
    - memory
    - gpu
    # Note: database_connections removed (PostgreSQL was removed for MVP)

# Report settings
reports:
  output_dir: "reports"
  format: ["html", "json", "csv"]
  include_charts: true
  comparison_baseline: "baseline"
